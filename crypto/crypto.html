<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Crypto CTF ‚Äì DALISEC ROT13 Challenge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #020617;
      color: #e5e7eb;
    }

    .card {
      background: #020617;
      border-radius: 1rem;
      padding: 2rem;
      max-width: 420px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
      border: 1px solid #1f2937;
    }

    h1 {
      font-size: 1.6rem;
      margin: 0 0 0.5rem;
      color: #facc15;
    }

    .sub {
      margin: 0 0 1.5rem;
      color: #9ca3af;
      font-size: 0.9rem;
    }

    .sub code {
      background: #111827;
      padding: 0.1rem 0.35rem;
      border-radius: 0.4rem;
      font-size: 0.85rem;
    }

    button {
      border: none;
      border-radius: 0.75rem;
      padding: 0.7rem 1.2rem;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
      width: 100%;
      margin-bottom: 1.4rem;
      background: linear-gradient(135deg, #4f46e5, #22c55e);
      color: white;
      font-weight: 600;
      box-shadow: 0 10px 30px rgba(37, 99, 235, 0.45);
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 40px rgba(37, 99, 235, 0.65);
    }

    form label {
      font-size: 0.9rem;
      color: #d1d5db;
      display: block;
      margin-bottom: 0.35rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.6rem 0.75rem;
      border-radius: 0.75rem;
      border: 1px solid #4b5563;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.9rem;
      margin-bottom: 0.85rem;
      outline: none;
    }

    input[type="text"]:focus {
      border-color: #6366f1;
      box-shadow: 0 0 0 1px #6366f1;
    }

    input[type="submit"] {
      border: none;
      border-radius: 0.75rem;
      padding: 0.6rem 1.2rem;
      font-size: 0.95rem;
      cursor: pointer;
      width: 100%;
      background: #22c55e;
      color: #022c22;
      font-weight: 600;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

    input[type="submit"]:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(34, 197, 94, 0.4);
    }

    .result {
      margin-top: 0.8rem;
      font-size: 0.9rem;
    }

    .success {
      color: #4ade80;
    }

    .error {
      color: #f97373;
    }

    .hint {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-top: 0.4rem;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üîê Crypto CTF</h1>
    <p class="sub">
      Download the Python challenge, decode the ROT13-based flag, and submit it here.<br>
      Flag format: <code>DALISEC{...}</code>
    </p>

    <button id="downloadBtn">üì• Download <code>crypto_ctf_with_hint.py</code></button>

    <form id="flagForm">
      <label for="flagInput">Enter decoded flag:</label>
      <input
        type="text"
        id="flagInput"
        name="flag"
        placeholder="DALISEC{...}"
        autocomplete="off"
        required
      />
      <input type="submit" value="Check Flag" />
      <div id="result" class="result"></div>
      <div class="hint">
        Hint: The script uses ROT13. Only an encoded version of the flag is stored.
      </div>
    </form>
  </div>

  <script>
    // === Python challenge file contents (updated to use DALISEC{} and hide real flag) ===
    const pythonContent = `# crypto_ctf_with_hint.py

import codecs

def main():
    encoded = "QNYVFRP{frperg_pvcure}" 

    print("üìú Intercepted ROT13 Message:")
    print(f"Flag looks like: {encoded}")
    print("\\nDecode it to get the real flag!")

    while True:
        user_input = input("\\nEnter decoded flag: ").strip()
        real_flag = codecs.decode(encoded, "rot_13")

        if user_input == real_flag:
            print("‚úÖ Correct! You captured the flag.")
            break
        else:
            print("‚ùå Incorrect. Hint: It's ROT13 ‚Äî try again!")

if __name__ == "__main__":
    main()
`;

    // Download .py file
    document.getElementById("downloadBtn").addEventListener("click", function () {
      const blob = new Blob([pythonContent], { type: "text/x-python" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "crypto_ctf_with_hint.py";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);

      URL.revokeObjectURL(url);
    });

    // Simple ROT13 implementation in JS so we also don't store the real flag in plaintext here
    function rot13(str) {
      return str.replace(/[A-Za-z]/g, (c) => {
        const base = c <= "Z" ? 65 : 97;
        return String.fromCharCode(((c.charCodeAt(0) - base + 13) % 26) + base);
      });
    }

    // This is the same encoded flag used in the Python script
    const encodedFlag = "QNYVFRP{frperg_pvcure}";
    const realFlag = rot13(encodedFlag); // => DALISEC{secret_cipher}

    const form = document.getElementById("flagForm");
    const resultEl = document.getElementById("result");

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      const value = document.getElementById("flagInput").value.trim();

      if (value === realFlag) {
        resultEl.textContent = "‚úÖ Correct! You captured the flag.";
        resultEl.className = "result success";
      } else {
        resultEl.textContent = "‚ùå Incorrect flag. Try again.";
        resultEl.className = "result error";
      }
    });
  </script>
</body>
</html>

